var CanvasCharts=function(){this.container=null;this.containerWidth="";this.containerHeight="";this.canvasEl=null;this.context=null;this.rotate=false;this.angle=0;this.gradientColor1="#cdeb8e";this.gradientColor2="#a5c956";this.textFillStyle="#666";this.lineStrokeStyle="#000";this.borderStrokeStyle="#000";this.bgFillStyle="#fff";this.font="";this.startX=45;this.xAxisStart=10;this.yAxisLeft=40;this.xAxisLineWidth=1;this.yAxisLineWidth=1;this.startY=0;this.barHeight=10;this.chartType="hbar"};CanvasCharts.prototype.configure=function(a){if(a.hasOwnProperty("bgFillStyle")){this.bgFillStyle=a.bgFillStyle}if(a.hasOwnProperty("borderStrokeStyle")){this.borderStrokeStyle=a.borderStrokeStyle}if(a.hasOwnProperty("rotate")){this.rotate=a.rotate}if(a.hasOwnProperty("angle")){this.angle=a.angle}if(a.hasOwnProperty("textFillStyle")){this.textFillStyle=a.textFillStyle}if(a.hasOwnProperty("lineStrokeStyle")){this.lineStrokeStyle=a.lineStrokeStyle}if(a.hasOwnProperty("startX")){this.startX=a.startX}if(a.hasOwnProperty("xAxisStart")){this.xAxisStart=a.xAxisStart}if(a.hasOwnProperty("yAxisLeft")){this.yAxisLeft=a.yAxisLeft}if(a.hasOwnProperty("startY")){this.startY=a.startY}if(a.hasOwnProperty("chartType")){this.chartType=a.chartType}if(a.hasOwnProperty("gradientColor1")){this.gradientColor1=a.gradientColor1}if(a.hasOwnProperty("gradientColor2")){this.gradientColor2=a.gradientColor2}if(a.hasOwnProperty("font")){this.font=a.font}if(a.hasOwnProperty("drawDataText")){this.drawDataText=a.drawDataText}};CanvasCharts.prototype.isCanvasSupported=function(){return !!document.createElement("canvas").getContext};CanvasCharts.prototype.createCanvas=function(b,e,a){this.containerWidth=e;this.containerHeight=a;if(b!=null){b.style.width=this.containerWidth+"px";b.style.height=this.containerHeight+"px"}this.container=b;var d=null;if(typeof document!=="undefined"){d=document.createElement("canvas")}else{if(typeof canvas!=="undefined"){d=new canvas(this.containerWidth,this.containerHeight)}}if(d==null){console.log("Could not create a canvas element! What are you using?");return false}this.canvasEl=d;d.id="canvas1";d.width=this.containerWidth;d.height=this.containerHeight;d.style.width=this.containerWidth+"px";d.style.height=this.containerHeight+"px";if(this.startY==0){this.startY=this.containerHeight-70}this.context=d.getContext("2d");var c=this.context;if(window.devicePixelRatio==2){d.width=this.containerWidth*2;d.height=this.containerHeight*2;c.scale(2,2)}this.drawRectBorder(0,0,this.containerWidth,this.containerHeight,this.borderStrokeStyle);this.drawRect(0,0,this.containerWidth,this.containerHeight,this.bgFillStyle);c.font="normal 12px sans-serif";c.textBaseline="top";return true};CanvasCharts.prototype.drawRectBorder=function(b,a,e,d,f){var c=this.context;c.strokeStyle=f;c.strokeRect(b,a,e,d)};CanvasCharts.prototype.drawRect=function(b,a,f,e,d){var c=this.context;c.fillStyle=d;c.fillRect(b,a,f,e)};CanvasCharts.prototype.drawChart=function(e,f,a,d,c){var b=this.context;if(b!=null){this.drawLine(this.xAxisStart,this.containerHeight-40,this.containerWidth-10,this.containerHeight-40,{lineWidth:this.xAxisLineWidth});if(f!=null&&e!=null){this.drawXAxisLabels(e,f,this.containerHeight-30,this.rotate,this.angle)}this.drawLine(this.yAxisLeft,10,this.yAxisLeft,this.containerHeight-10,{lineWidth:this.yAxisLineWidth});if(a!=null&&d!=null){this.drawYAxisLabels(a,d,10)}this.xScale=(this.containerWidth-this.startX)/e[e.length-1];if(this.chartType=="hbar"){this.drawHBars(c,d)}else{if(this.chartType=="line"){if(typeof this.drawLineSeries==="function"){this.drawLineSeries(c,f)}else{console.log("Could not find the line drawing function. Did you forget to add the 'cc.line.js' file?")}}}}else{console.log("Context is null. Cannot draw!")}};CanvasCharts.prototype.drawXAxisLabels=function(g,h,j,d,c){if(!g){return}var b=g.length;var f=this.startX;var a=this.context;if(d){this.rotateCanvas(a,c)}for(var e=0;e<b;e+=1){if(e==0){this.drawText(g[e],f,j)}else{f+=h;this.drawText(g[e],f,j)}}if(d){a.restore()}};CanvasCharts.prototype.drawYAxisLabels=function(f,c,b){if(!f){return}var e=f.length;var a=this.startY;for(var d=0;d<e;d+=1){if(d==0){this.drawText(f[d],b,a)}else{a-=c+10;this.drawText(f[d],b,a)}}};CanvasCharts.prototype.drawText=function(c,a,d){var b=this.context;if(this.font!=""){b.font=this.font}b.fillStyle=this.textFillStyle;b.fillText(c,a,d)};CanvasCharts.prototype.rotateCanvas=function(a,b){a.save();a.rotate(b)};CanvasCharts.prototype.drawLine=function(b,a,f,e,c){var d=this.context;if(c){d.strokeStyle=(c.hasOwnProperty("strokeStyle"))?c.strokeStyle:this.lineStrokeStyle;d.lineWidth=(c.hasOwnProperty("lineWidth"))?c.lineWidth:1;d.lineCap=(c.hasOwnProperty("lineCap"))?c.lineCap:"square"}else{d.strokeStyle=this.lineStrokeStyle;d.lineWidth=10;d.lineCap="square"}d.beginPath();d.moveTo(b,a);d.lineTo(f,e);d.stroke();d.closePath()};CanvasCharts.prototype.drawCircle=function(b,g,a,d){var f="#000000";var c="#000000";if(d){f=(d.hasOwnProperty("strokeStyle"))?d.strokeStyle:"#000000";c=(d.hasOwnProperty("fillStyle"))?d.fillStyle:"#000000"}var e=this.context;e.strokeStyle=f;e.fillStyle=c;e.beginPath();e.arc(b,g,a,0,Math.PI*2,true);e.closePath();e.stroke();e.fill()};CanvasCharts.prototype.createGradient=function(){var a=this.context;var b=a.createLinearGradient(0,0,300,0);b.addColorStop(0,this.gradientColor1);b.addColorStop(1,this.gradientColor2);this.barGradient=b};CanvasCharts.prototype.drawHBars=function(d,h){if(!d){console.log("data is undefined! Please pass an array containing at least one number.");return}this.createGradient();var a=this.context;var g=this.startY+10;var f=this.startX+1;var b=d.length;var c={lineWidth:this.barHeight,strokeStyle:this.barGradient};for(var e=0;e<b;e+=1){var j=f+(this.xScale*d[e]);this.drawLine(f,g,j,g,c);if(this.drawDataText){this.drawText(d[e],j+8,g-10)}g-=h+10}};CanvasCharts.prototype.showChart=function(){if(this.container!=null&&this.canvasEl!=null){this.container.innerHTML="";this.container.appendChild(this.canvasEl)}else{return this.canvasEl.toDataURL()}};CanvasCharts.prototype.destroyCanvas=function(){this.context=null;this.canvasEl=null;this.container.innerHTML="";this.container=null;console.log("canvas destroyed")};module.exports=new CanvasCharts();